<html>
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
        <link rel="stylesheet" href="./styles.css">
    </head>
    <body>
      <div class="pos-f-t">
        <div class="collapse" id="navbarToggleExternalContent">
          <div class="bg-dark p-4">
            <h5 class="text-white h4">Collapsed content</h5>
            <span class="text-muted">Toggleable via the navbar brand.</span>
          </div>
        </div>
    <nav class="navbar navbar-dark bg-dark">
      <div class="dropdown">
      <button class="navbar-toggler" type="dropbtn" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
      <div class="dropdown-content dropdown-menu" area-labelledby="dropdown">
        <a href="login.html">Login</a>
        <a href="menu.html">Menu</a>
        <a href="results.html">Results</a>
      </div>
      </div>
    </nav>
  </div>
        <div class="container">
            <img id="myImg" src="imgs/logo.jpg">
            <canvas id="overlay" width="0" height="0" ></canvas>
        </div>

        <div id="console"></div>
        <div id="btn">
            Картинка:
            <input id="myFileUpload" type="file" accept=".jpg, .jpeg, .png">
        </div>
        <script>
            function getFaceDetectorOptions() {
                return new faceapi.SsdMobilenetv1Options({ minConfidence: 0.5 })
            }

            function init() {
                $('#btn').show();
                $('#myFileUpload').change(function (e) {
                    const imgFile = $('#myFileUpload')[0].files[0];
                    $('#console').text('GET PICTURE');
                    // create an HTMLImageElement from a Blob
                    faceapi.bufferToImage(imgFile).then((img) => {
                        $('#myImg')[0].src = img.src;

                        $('#console').text('DETECTION');
                        faceapi.detectAllFaces($('#myImg')[0], getFaceDetectorOptions())
                            .withFaceExpressions()
                            .then((r) => {
                                $('#console').text('GUUT');
                                console.log(r);
                                drawExpressions($('#myImg').get(0), $('#overlay').get(0), r, 0.5, true)
                            });

                    });
                });
            }

            $(document).ready(() => {
                $('#btn').hide();
                $('#console').text('START');
                faceapi.loadSsdMobilenetv1Model('./weights')
                    .then(() => faceapi.loadFaceExpressionModel('./weights'))
                    .then(() => {
                        $('#console').text('MODEL LOADED');
                        init();
                    });
            });
        </script>
    </body>
</html>
